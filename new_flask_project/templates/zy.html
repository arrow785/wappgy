<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸»é¡µ - ä¸ªäººè®ºå›</title>
    <link href="../static/css/bootstrap.css" rel="stylesheet">
    <link href="../static/css/my.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            background-image: url('');
            background-size: cover;
        }

        .navbar {
            background-color: rgba(255, 255, 255, 0.1);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .carousel {
            margin-top: 10px;
            margin-left: 20px;
            margin-right: 20px;
        }

        .carousel-inner img {
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 8px;
        }

        .footer {
            background-color: #f8f9fa;
            padding: 1rem 0;
            text-align: center;
            margin-top: auto;
        }

        .welcome-message {
            text-align: center;
            margin-top: 10px;
            padding: 10px;
            margin-right: 20px;
            margin-left: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .welcome-message h1 {
            font-size: 28px;
            margin-bottom: 10px;
            color: #333;
        }

        .welcome-message p {
            font-size: 18px;
            color: #666;
        }

        .featured-content {
            margin: 20px;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .featured-content h2 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #333;
        }

        .featured-content p {
            font-size: 16px;
            color: #666;
        }

        .featured-content a {
            color: #007bff;
            text-decoration: none;
        }

        .featured-content a:hover {
            text-decoration: underline;
        }

        .social-links {
            text-align: center;
            margin-top: 20px;
        }

        .social-links a {
            margin: 0 10px;
            color: #007bff;
            text-decoration: none;
        }

        .social-links a:hover {
            text-decoration: underline;
        }

        .news-section {
            margin-top: 10px;
            margin-left: 20px;
            margin-right: 20px;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .news-section h2 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #333;
        }

        .news-section p {
            font-size: 16px;
            color: #666;
        }

        .news-section a {
            color: #007bff;
            text-decoration: none;
        }

        .news-section a:hover {
            text-decoration: underline;
        }

        .music-section {
            margin-top: 10px;
            margin-left: 20px;
            margin-right: 20px;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .music-section h2 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #333;
        }

        .tools-section {
            margin-top: 10px;
            margin-left: 20px;
            margin-right: 20px;
            margin-bottom: 10px;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .tools-section h2 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #333;
        }

        .tools-section .tool {
            margin-bottom: 10px;
        }

        .tools-section .tool a {
            color: #007bff;
            text-decoration: none;
        }

        .tools-section .tool a:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="{{url_for('main')}}">æ–°å¹´å¿«ä¹ğŸ¥³</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/index">æ–‡ç« </a>
                    </li>
                    
                    {% if username == 'd' or username == None %}
                    <li class="nav-item">
                        <a class="nav-link" href="/login">ç™»å½•</a>
                    </li>
                    {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="/boards">ç•™è¨€æ¿</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/people">ä¸ªäººä¸»é¡µ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/logout">ç™»å‡º</a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- æ¬¢è¿ä¿¡æ¯ -->
    <div class="welcome-message">
        <h1></h1>
        {% if username == 'd' or username == None %}
        <h1>æ¬¢è¿ï¼æ–°å¹´å¿«ä¹ğŸ‰ğŸ¥³ğŸ¥°</h1>
        <p>ç™»å½•åï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹æ›´å¤šå†…å®¹ã€å‚ä¸è®¨è®ºå’Œåˆ†äº«æ‚¨çš„è§‚ç‚¹ğŸ–Šã€‚</p>
        {% else %}
        <h1>æ¬¢è¿å›æ¥ï¼Œ{{ username }}ğŸˆæ–°å¹´å¿«ä¹ğŸ‰ğŸ¥³ï¼</h1>
        <p>ç»§ç»­æ¢ç´¢æˆ‘ä»¬çš„è®ºå›ï¼Œäº«å—æ›´å¤šå†…å®¹å’Œäº’åŠ¨ã€‚</p>
        {% endif %}
        <p id="curr_weather">æ­£åœ¨è·å–å¤©æ°”ä¿¡æ¯.....</p>
    </div>
    <!-- è½®æ’­å›¾ -->
    <div class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <!-- è‡ªé€‚åº” å›¾ç‰‡ -->
                <img onclick="next()" style="width: 100%; display: block;" id="img1" src="" alt="è¯·è€å¿ƒç­‰å¾…"></img>
            </div>
        </div>
    </div>


    <!-- æ–°é—»æ‘˜è¦ -->
    <div class="news-section">
        <h2>æ–°é—»æ‘˜è¦</h2>
        <p>ä»¥ä¸‹æ˜¯æœ€è¿‘çš„çƒ­é—¨æ–°é—»ï¼Œæ¥æºäº{{ news['from'] }}ï¼Œæœ€åæ›´æ–°äº{{ news['update'] }}</p>
        <ol>
            {% for i in news['data'] %}
            <li><a class="text-muted" href="{{i['url']}}" target="_blank">{{ i['title']
                    }}&nbsp;&nbsp;&nbsp;<i>ï¼ˆ{{ i['hot']}}ï¼‰</i></a></li>
            {% endfor %}
        </ol>
    </div>

    <!-- å“”å“©å“”å“©åœ¨çº¿è§†é¢‘ -->
    <div class="music-section">
        <h2>çœ‹ä¸¤éƒ¨çŸ­ç‰‡å§</h2>
        <iframe style="border-radius:12px"
            src="//player.bilibili.com/player.html?isOutside=true&aid=52012946&bvid=BV1z4411Y7tX&cid=365220412&p=1&high_quality=1"
            scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" width="100%"
            height="400px"></iframe>
        <!--  -->
        <iframe style="border-radius:12px"
            src="//player.bilibili.com/player.html?isOutside=true&aid=320668905&bvid=BV17w411U7qm&cid=1259280876&p=1&high_quality=1"
            scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" width="100%"
            height="400px"></iframe>
    </div>

    <!-- å®ç”¨å°å·¥å…· -->
    <div class="tools-section">
        <h2>ä¸æ˜¯é‚£ä¹ˆå®ç”¨çš„å®ç”¨å°å·¥å…·ï¼ˆæ»‘ç¨½Dogeï¼‰</h2>
        <div class="tool">
            <a href="https://www.calculator.net/" target="_blank">åœ¨çº¿è®¡ç®—å™¨</a>
        </div>
        <div class="tool">
            <a href="https://www.weather.com/" target="_blank">å¤©æ°”æŸ¥è¯¢</a>
        </div>
    </div>



    <!-- é¡µè„š -->
    {% include 'footer.html' %}

    <!-- Bootstrap JS -->
    <script src="../static/js/bootstrap.bundle.min.js"></script>
    <script>
        function onl() {
            fetch('https://bing.biturl.top')
                .then(response => response.json())
                .then(data => {
                    url = data.url
                    document.body.style.backgroundImage = `url(${url})`
                })
                .catch(error => {
                    console.error('Error:', error);
                });
            next();
        }
        function next() {
            var baseUrl = "{{ url_for('next1') }}"
            fetch(baseUrl)
                .then(response => response.json())
                .then(data => {
                    url = data.url
                    document.getElementById('img1').src = url
                    document.getElementById('img1').title = data.title
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

        function curr_weather() {
            var baseUrl = "{{ url_for('curr_weather') }}"
            fetch(baseUrl)
                .then(response => response.json())
                .then(data => {
                    console.log(data)
                    document.getElementById('curr_weather').innerHTML = data.city + 'ï¼Œ' + data.data.type;
                }).catch(error => {
                    console.error('Error:', error);
                });

        }
        var time = 1 * 60 * 1000;
        setInterval(next, time);
        window.onload = function () {
            onl();
        };
        const apiKey = "b58e1f74ceee1e528b6c633db2549731";
        function getCurrentCity() {
            if ("geolocation" in navigator) {
                console.log("æ­£åœ¨è·å–ä½ç½®ä¿¡æ¯...");
                navigator.geolocation.getCurrentPosition(
                    function (position) {
                        const latitude = position.coords.latitude; // çº¬åº¦
                        const longitude = position.coords.longitude; // ç»åº¦
                        getCityNameByLocation(latitude, longitude);
                    },
                    function (error) {
                        setTimeout(function () {
                            document.getElementById('curr_weather').innerHTML = `æ— æ³•è·å–ä½ç½®ä¿¡æ¯......`;
                        }, 3000);
                        console.error("è·å–ä½ç½®ä¿¡æ¯å¤±è´¥ï¼š", error);
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 5000
                    }
                );
            } else {
                console.error("æµè§ˆå™¨ä¸æ”¯æŒGeolocation API");
            }
        }

        function getCityNameByLocation(lat, lng) {
            // æ›¿æ¢ä¸ºä½ çš„é«˜å¾·åœ°å›¾API Key
            const url = `https://restapi.amap.com/v3/geocode/regeo?key=${apiKey}&location=${lng},${lat}&extensions=all`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.status === "1" && data.info === "OK") {
                        // å¤„ç†è·å–åˆ°çš„åŸå¸‚ä¿¡æ¯
                        const adcode = data.regeocode.addressComponent.adcode;
                        curr_weather(adcode);
                    } else {
                        // å»¶è¿Ÿ3s
                        setTimeout(function () {
                            document.getElementById('curr_weather').innerHTML = `æ— æ³•è·å–ä½ç½®ä¿¡æ¯......`;
                        }, 3000);
                       
                        console.error("æ— æ³•è·å–åŸå¸‚ä¿¡æ¯ï¼š", data.info);
                    }
                })
                .catch(error => {
                    console.error("è¯·æ±‚é€†åœ°ç†ç¼–ç å¤±è´¥ï¼š", error);
                });
        }
        function curr_weather(adcode) {
            fetch(`https://restapi.amap.com/v3/weather/weatherInfo?key=${apiKey}&city=${adcode}&extensions=base`)
            .then(response => response.json())
            .then(data => {
                console.log(data)
                document.getElementById('curr_weather').innerHTML = `${data.lives[0].city}ï¼Œ${data.lives[0].weather}ï¼Œ${data.lives[0].temperature_float}â„ƒ`;
            }).catch(error => {
                console.error('Error:', error);
            });

        }
        // è°ƒç”¨å‡½æ•°è·å–å½“å‰åŸå¸‚
        getCurrentCity();
    </script>
</body>

</html>